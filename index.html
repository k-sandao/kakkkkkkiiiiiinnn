<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>石計算ツール</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h2, h3 {
      margin-top: 20px;
    }
    .pack {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    .slider-container {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <h2>石計算ツール</h2>

  <div id="current-stones">
    <h3>現在の所持数</h3>
    <label>有償石: <input type="number" id="currentPaid" value="0"></label><br>
    <label>無償石: <input type="number" id="currentFree" value="0"></label><br>
    <label>クーポン: <input type="number" id="currentCoupon" value="0"></label><br>
  </div>

  <h3>購入可能パック</h3>
  <div id="packs"></div>

  <button onclick="calculate()">計算する</button>

  <div id="result"></div>

  <script>
    // 既存＋新しいパック
    const packs = [
      { 
        name: "初心者応援パック", 
        price: 1000, 
        paid: 10, 
        free: 0, 
        coupon: 1, 
        multiple: false 
      },
      { 
        name: "上級者限定パック", 
        price: 5000, 
        paid: 30, 
        free: 20, 
        coupon: 2, 
        multiple: false 
      },
      { 
        name: "魔導石月末パック", 
        price: 3000, 
        paid: 25, 
        free: 25, 
        coupon: 0, 
        multiple: false // 1回のみ → チェックボックス
      },
      { 
        name: "魔導石パックpremium(140)", 
        price: 9800, 
        paid: 50, 
        free: 90, 
        coupon: 0, 
        multiple: true, 
        limit: 3 // 複数回可能 → スライダー
      }
    ];

    // パック選択UIを生成
    packs.forEach((pack, i) => {
      let inputField = "";

      if (pack.multiple) {
        if (pack.limit) {
          inputField = `
            <div class="slider-container">
              <input type="range" id="qty${i}" min="0" max="${pack.limit}" value="0" 
                oninput="document.getElementById('qtyVal${i}').innerText=this.value">
              <span id="qtyVal${i}">0</span> 回
            </div>
          `;
        } else {
          inputField = `<input type="number" id="qty${i}" min="0" value="0">`;
        }
      } else {
        inputField = `<input type="checkbox" id="check${i}">`;
      }

      document.getElementById("packs").innerHTML += `
        <div class="pack">
          <strong>${pack.name}</strong> (${pack.price}円)<br>
          有償: ${pack.paid}, 無償: ${pack.free}, クーポン: ${pack.coupon}
          ${inputField}
        </div>
      `;
    });

    // 計算処理
    function calculate() {
      let totalPrice = 0;
      let totalPaid = parseInt(document.getElementById("currentPaid").value) || 0;
      let totalFree = parseInt(document.getElementById("currentFree").value) || 0;
      let totalCoupon = parseInt(document.getElementById("currentCoupon").value) || 0;

      packs.forEach((pack, i) => {
        let qty = 0;

        if (pack.multiple) {
          qty = parseInt(document.getElementById(`qty${i}`).value) || 0;
        } else {
          qty = document.getElementById(`check${i}`)?.checked ? 1 : 0;
        }

        totalPrice += pack.price * qty;
        totalPaid += pack.paid * qty;
        totalFree += pack.free * qty;
        totalCoupon += (pack.coupon || 0) * qty;
      });

      document.getElementById("result").innerHTML = `
        <h3>結果</h3>
        <p>合計金額: ${totalPrice} 円</p>
        <p>有償石: ${totalPaid}</p>
        <p>無償石: ${totalFree}</p>
        <p>クーポン: ${totalCoupon}</p>
      `;
    }
  </script>
</body>
</html>
